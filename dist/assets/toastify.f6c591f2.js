import{a as y,d as L,r as I}from"./vendor.423aa499.js";const P=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}};P();const k="http://js-post-api.herokuapp.com/api",d=y.create({baseURL:k,headers:{"Content-Type":"application/json"}});y.interceptors.request.use(function(e){console.log("request interceptor",e);const t=localStorage.getItem("fake_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},function(e){return Promise.reject(e)});d.interceptors.request.use(async e=>e);d.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});const q={getAll(e){const t="/posts";return d.get(t,{params:e})},getById(e){const t=`/posts/${e}`;return d.get(t)},add(e){const t="/posts";return d.post(t,e)},update(e){const t=`/posts/${e.id}`;return d.patch(t,e)},addFormData(e){const t="with-thumbnail/posts";return d.post(t,e,{headers:{"Content-Type":"multipart/form-data"}})},updateFormData(e){const t=`with-thumbnail/posts/${e.get("id")}`;return d.patch(t,e,{headers:{"Content-Type":"multipart/form-data"}})},remove(e){const t=`/posts/${e}`;return d.delete(t)}};function h(e,t,n){if(!e)return;const r=e.querySelector(t);r&&(r.textContent=n)}function w(e,t){return t.length<=100?t:`${t.slice(0,e-1)}...`}function A(e,t,n){if(!e)return;const r=e.querySelector(t);r.value=n}function N(e,t,n){let r=e.getElementById(t);r&&(r.style.backgroundImage=`url(${n})`)}function C(e){const t=Math.random()*e;return Math.round(t)}function g(e,t){t||(t=1),e.forEach(n=>{let r=n.firstElementChild;const s=Number.parseInt(r.innerText);r.innerText=s+t})}function v(e,t){t||(t=1),e.forEach(n=>{let r=n.firstElementChild;const s=Number.parseInt(r.innerText);r.innerText=s-t})}function m(e,t){t||(t=1),e.forEach(n=>{n.innerText==t?n==null||n.firstElementChild.classList.add("active-page"):n==null||n.firstElementChild.classList.remove("active-page")})}function T(e,t){e.forEach(n=>{n.innerText==t+1?n.classList.add("disabled"):n.classList.remove("disabled")})}function $({elementId:e,defaultParams:t,onChange:n}){var u,c;const r=document.getElementById(e);if(!r)return;const s=(u=r.firstElementChild)==null?void 0:u.firstElementChild,o=(c=r.lastElementChild)==null?void 0:c.lastElementChild,i=r.querySelectorAll("li:not(:first-child):not(:last-child)");i.forEach((l,a)=>{l.addEventListener("click",function(f){f.preventDefault();const E=Number.parseInt(r.dataset.page),b=Number.parseInt(r.dataset.totalPages);let p=Number.parseInt(l.innerText);E+1>=b&&T(i,E),n==null||n(p),a!=i.length-1&&m(i,p),a===i.length-1&&(g(i),m(i,p)),a==0&&p>1&&(v(i),m(i,p))})}),s.addEventListener("click",l=>{l.preventDefault();const a=Number.parseInt(r.dataset.page);Array.from(i)[0].innerText>a-1&&v(i),m(i,a-1),a>=2&&n(a-1)}),o.addEventListener("click",l=>{l.preventDefault();const a=Number.parseInt(r.dataset.page)||1,f=Number.parseInt(r.dataset.totalPages);Array.from(i)[i.length-1].innerText<a+1&&g(i),m(i,a+1),f>=a&&(n==null||n(a+1))})}function _(e,t){var u,c,l,a;const{_page:n,_limit:r,_totalRows:s}=t,o=Math.ceil(s/n),i=document.getElementById(e);i.dataset.page=n,i.dataset.totalPages=o,n<=1?(u=i.firstElementChild)==null||u.classList.add("disabled"):(c=i.firstElementChild)==null||c.classList.remove("disabled"),n>=o?(l=i.lastElementChild)==null||l.classList.add("disabled"):(a=i.lastElementChild)==null||a.classList.remove("disabled")}(()=>{const e=new URLSearchParams(window.location.search);if(new URL(window.location).href.indexOf("_page")>-1){const n=e.get("_page"),r=document.querySelectorAll("#pagination  li:not(:first-child):not(:last-child)"),s=r[r.length-1].innerText;s<n&&g(r,n-s),m(r,n)}})();L.extend(I);function x(e){if(!e)return;const t=document.querySelector("#postItemTemplate");if(!t)return;const n=t.content.firstElementChild.cloneNode(!0);if(!n)return;h(n,'[data-id="title"]',e.title),h(n,'[data-id="author"]',e.author),h(n,'[data-id="description"]',w(90,e.description));const r=n.querySelector('[data-id="thumbnail"]');r&&(r.src=e.imageUrl);const s=L(e.updatedAt).fromNow();h(n,'[data-id="timeSpan"]',`- ${s}`);const o=n.firstElementChild;o.addEventListener("click",c=>{const l=o.querySelector("[data-id = 'post-menu']");l&&l.contains(c.target)||window.location.assign(`/post-detail.html?id=${e.id}`)}),o.querySelector("#editPostBtn").addEventListener("click",()=>{window.location.assign(`/add-edit-post.html?id=${e.id}`)});const u=n.querySelectorAll('[name="delete-button"]');return u&&u.forEach(c=>c.addEventListener("click",function(){let l=new bootstrap.Modal(document.getElementById("modal-confirm-delete-post"),{keyboard:!1});l.show();const a=`<a href=/post-detail.html?id=${e.id} style="color: blue; text-decoration:none">${e.title}</a>`;l._element.querySelector(".modal-body").innerHTML=`Are you sure to romove post: ${a}`;const f=new CustomEvent("post-delete",{bubbles:!0,detail:{post:e,myModal:l}});c.dispatchEvent(f)})),n}function B(e){if(!Array.isArray(e))return;const t=document.querySelector("#postList");!t||(t.textContent="",e.forEach(n=>{const r=x(n);t.appendChild(r)}))}export{_ as a,A as b,N as c,C as d,$ as i,q as p,B as r,h as s};
